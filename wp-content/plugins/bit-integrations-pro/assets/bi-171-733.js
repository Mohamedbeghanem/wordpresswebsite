var o=Object.defineProperty;var R=Object.getOwnPropertySymbols;var f=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var A=(e,g,d)=>g in e?o(e,g,{enumerable:!0,configurable:!0,writable:!0,value:d}):e[g]=d,D=(e,g)=>{for(var d in g||(g={}))f.call(g,d)&&A(e,d,g[d]);if(R)for(var d of R(g))w.call(g,d)&&A(e,d,g[d]);return e};var v=(e,g,d)=>new Promise((c,_)=>{var n=p=>{try{u(d.next(p))}catch(a){_(a)}},t=p=>{try{u(d.throw(p))}catch(a){_(a)}},u=p=>p.done?c(p.value):Promise.resolve(p.value).then(n,t);u((d=d.apply(e,g)).next())});import{A as E,B,D as G,R as z,E as U,G as ee,F as V,H as J,I as K,J as L,K as N,N as O,O as q,P as Z,Q as j,U as Q,V as X,W as Y,X as te,Y as ae,Z as x,a0 as T,b as P,$ as ie,a1 as re,e as se,_ as y,a as ne}from"./bi-336-181.js";import{n as W}from"./main.js";const ge=["Webhook","KaliForms","Amelia","WPFunnels","Typebot","JetForm","FluentSupport"],l=e=>ge.includes(e),pe=(e,g,d,c,_,n,t,u)=>v(void 0,null,function*(){var r,C,m,S,I,h,b,H;let p="flow/save";u(!0);let a=c;if(((r=c==null?void 0:c.condition)==null?void 0:r.action_behavior)!=="cond"&&(a.condition={action_behavior:"",actions:[{field:"",action:"value"}],logics:[{field:"",logic:"",val:""},"or",{field:"",logic:"",val:""}]}),e.triggered_entity==="Elementor"||e.triggered_entity==="Divi"||e.triggered_entity==="Bricks"||e.triggered_entity==="Brizy"||e.triggered_entity==="Breakdance"||e.triggered_entity==="CartFlow")t?a.postId=(m=(C=e==null?void 0:e.flow_details)==null?void 0:C.postId)!=null?m:null:a.postId=(I=(S=e==null?void 0:e.triggerData)==null?void 0:S.postId)!=null?I:null;else if(e.triggered_entity==="TutorLms"){const i=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;a=E(a,i)}else if(e.triggered_entity==="WC"){const i=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;a=B(a,i)}else if(e.triggered_entity==="Groundhogg"){const i=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;a=G(a,i)}else if(e.triggered_entity==="RestrictContent"){const i=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;a=z(a,i)}else if(e.triggered_entity==="LearnDash"){const i=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;a=U(a,i)}else if(e.triggered_entity==="GamiPress"){const i=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;a=ee(a,i)}else if(e.triggered_entity==="Affiliate"){const i=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;a=V(a,i)}else if(e.triggered_entity==="BuddyBoss"){const i=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;a=J(a,i)}else if(e.triggered_entity==="WPCourseware"){const i=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;a=K(a,i)}else if(e.triggered_entity==="FluentCrm"){const i=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;a=L(a,i)}else if(e.triggered_entity==="Post"){const i=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;a=N(a,i)}else if(e.triggered_entity==="JetEngine"){const i=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;a=O(a,i)}else if(e.triggered_entity==="Memberpress"){const i=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;a=q(a,i)}else if(e.triggered_entity==="PaidMembershipPro"){const i=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;a=Z(a,i)}else if(e.triggered_entity==="SliceWp"){const i=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;a=j(a,i)}else if(e.triggered_entity==="SureCart"){const i=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;a=Q(a,i)}else if(e.triggered_entity==="GiveWp"){const i=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;a=X(a,i)}else if(e.triggered_entity==="LifterLms"){const i=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;a=Y(a,i)}else if(e.triggered_entity==="MasterStudyLms"){const i=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;a=te(a,i)}else if(e.triggered_entity==="ThriveApprentice"){const i=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;a=ae(a,i)}else if(e.triggered_entity==="EDD"){const i=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;a=x(a,i)}else if(e.triggered_entity==="UltimateMember"){const i=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;a=T(a,i)}const F={name:c.name,trigger:e.triggered_entity,triggered_entity_id:(h=e==null?void 0:e.triggerData)!=null&&h.formID?e.triggerData.formID:e.triggered_entity_id||0,flow_details:a};e.id&&(F.id=e.id),l(e.triggered_entity)&&(F.flow_details.fields=t?(H=e==null?void 0:e.flow_details)==null?void 0:H.fields:(b=e==null?void 0:e.triggerDetail)==null?void 0:b.data),t&&(p="flow/update");try{const i=yield P(F,p);return!t&&i.success&&(_(d),W(ie),W(re),W(se)),u(!1),i}catch(i){return u(!1),y("Failed to save integration","bit-integrations")}}),ye=a=>v(void 0,[a],function*({flow:e,setFlow:g,allIntegURL:d,conf:c,navigate:_,index:n,edit:t,setIsLoading:u,setSnackbar:p}){var m,S,I,h,b,H,i;let F="flow/save";u&&u instanceof Function&&u(!0);let r=c;if(e.triggered_entity==="Elementor"||e.triggered_entity==="Divi"||e.triggered_entity==="Bricks"||e.triggered_entity==="Brizy"||e.triggered_entity==="Breakdance"||e.triggered_entity==="CartFlow")t?r.postId=(S=(m=e==null?void 0:e.flow_details)==null?void 0:m.postId)!=null?S:null:r.postId=(h=(I=e==null?void 0:e.triggerData)==null?void 0:I.postId)!=null?h:null;else if(e.triggered_entity==="TutorLms"){const s=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;r=E(r,s)}else if(e.triggered_entity==="WC"){const s=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;r=B(r,s)}else if(e.triggered_entity==="Groundhogg"){const s=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;r=G(r,s)}else if(e.triggered_entity==="RestrictContent"){const s=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;r=z(r,s)}else if(e.triggered_entity==="LearnDash"){const s=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;r=U(r,s)}else if(e.triggered_entity==="BuddyBoss"){const s=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;r=J(r,s)}else if(e.triggered_entity==="WPCourseware"){const s=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;r=K(r,s)}else if(e.triggered_entity==="FluentCrm"){const s=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;r=L(r,s)}else if(e.triggered_entity==="Post"){const s=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;r=N(r,s)}else if(e.triggered_entity==="JetEngine"){const s=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;r=O(r,s)}else if(e.triggered_entity==="Affiliate"){const s=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;r=V(r,s)}else if(e.triggered_entity==="Memberpress"){const s=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;r=q(r,s)}else if(e.triggered_entity==="PaidMembershipPro"){const s=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;r=Z(r,s)}else if(e.triggered_entity==="SliceWp"){const s=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;r=j(r,s)}else if(e.triggered_entity==="SureCart"){const s=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;r=Q(r,s)}else if(e.triggered_entity==="GiveWp"){const s=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;r=X(r,s)}else if(e.triggered_entity==="LifterLms"){const s=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;r=Y(r,s)}else if(e.triggered_entity==="EDD"){const s=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;r=x(r,s)}else if(e.triggered_entity==="UltimateMember"){const s=t?e==null?void 0:e.flow_details:e==null?void 0:e.triggerData;r=T(r,s)}const C={name:c.name,trigger:e.triggered_entity,triggered_entity_id:(b=e==null?void 0:e.triggerData)!=null&&b.formID?e.triggerData.formID:e.triggered_entity_id||0,flow_details:r};e.id&&(C.id=e.id),l(e.triggered_entity)&&(C.flow_details.fields=t?(i=e==null?void 0:e.flow_details)==null?void 0:i.fields:(H=e==null?void 0:e.triggerDetail)==null?void 0:H.data),t&&(F="flow/update");try{yield P(C,F).then(s=>{var M;!t&&s.success&&_(d);let $="",k="success";(M=s.data)!=null&&M.msg?$=s.data.msg:s.success?$=t?y("Integration updated successfully","bit-integrations"):y("Integration saved successfully","bit-integrations"):(k="error",$=t?y("Failed to update integration","bit-integrations"):y("Failed to save integration","bit-integrations")),ne($,{type:k}),u&&u instanceof Function&&u(!1),t||setTimeout(()=>{_(d)},700)})}catch(s){return u&&u instanceof Function&&u(!1),y("Failed to save integration","bit-integrations")}}),me=e=>{const g={},c=window.location.href.replace(`${window.opener.location.href}/redirect`,"").split("&");c&&c.forEach(_=>{const n=_.split("=");n[1]&&(g[n[0]]=n[1])}),localStorage.setItem(`__${e}`,JSON.stringify(g)),window.close()},De=(e,g,d,c,_,n,t,u,p,a)=>{if(!c.dataCenter||!c.clientId||!c.clientSecret){n({dataCenter:c.dataCenter?"":y("Data center cann't be empty","bit-integrations"),clientId:c.clientId?"":y("Client ID cann't be empty","bit-integrations"),clientSecret:c.clientSecret?"":y("Secret key cann't be empty","bit-integrations")});return}u(!0);const F=`https://accounts.zoho.${c.dataCenter}/oauth/v2/auth?scope=${d}&response_type=code&client_id=${c.clientId}&prompt=Consent&access_type=offline&state=${encodeURIComponent(window.location.href)}/redirect&redirect_uri=${encodeURIComponent(`${a.api.base}`)}/redirect`,r=window.open(F,e,"width=400,height=609,toolbar=off"),C=setInterval(()=>{if(r.closed){clearInterval(C);let m={},S=!1;const I=localStorage.getItem(`__${e}`);if(I&&(S=!0,m=JSON.parse(I),localStorage.removeItem(`__${e}`)),!m.code||m.error||!m||!S){const h=m.error?`Cause: ${m.error}`:"";p({show:!0,msg:`${y("Authorization failed","bit-integrations")} ${h}. ${y("please try again","bit-integrations")}`}),u(!1)}else{const h=D({},c);h.accountServer=m["accounts-server"],de(g,m,h,_,t,u,p,a)}}},500)},de=(e,g,d,c,_,n,t,u)=>{const p=D({},g);p.dataCenter=d.dataCenter,p.clientId=d.clientId,p.clientSecret=d.clientSecret,p.redirectURI=`${u.api.base}/redirect`,P(p,`${e}_generate_token`).then(a=>a).then(a=>{if(a&&a.success){const F=D({},d);F.tokenDetails=a.data,c(F),_(!0),t({show:!0,msg:y("Authorized Successfully","bit-integrations")})}else a&&a.data&&a.data.data||!a.success&&typeof a.data=="string"?t({show:!0,msg:`${y("Authorization failed Cause:","bit-integrations")}${a.data.data||a.data}. ${y("please try again","bit-integrations")}`}):t({show:!0,msg:y("Authorization failed. please try again","bit-integrations")});n(!1)})},Fe=(e,g,d,c,_)=>{const n=D({},g);_?c?n.relatedlists[_-1].upload_field_map.splice(e,0,{}):n.relatedlists[_-1].field_map.splice(e,0,{}):c?n.upload_field_map.splice(e,0,{}):n.field_map.splice(e,0,{}),d(D({},n))},he=(e,g,d,c,_)=>{const n=D({},g);_?c?n.relatedlists[_-1].upload_field_map.length>1&&n.relatedlists[_-1].upload_field_map.splice(e,1):n.relatedlists[_-1].field_map.length>1&&n.relatedlists[_-1].field_map.splice(e,1):c?n.upload_field_map.length>1&&n.upload_field_map.splice(e,1):n.field_map.length>1&&n.field_map.splice(e,1),d(D({},n))},Ce=(e,g,d,c,_,n)=>{const t=D({},d);n?_?t.relatedlists[n-1].upload_field_map[g][e.target.name]=e.target.value:t.relatedlists[n-1].field_map[g][e.target.name]=e.target.value:_?t.upload_field_map[g][e.target.name]=e.target.value:t.field_map[g][e.target.name]=e.target.value,e.target.value==="custom"&&(n?t.relatedlists[n-1].field_map[g].customValue="":t.field_map[g].customValue=""),c(D({},t))},Se=(e,g,d,c,_)=>{const n=D({},d);_?n.relatedlists[_-1].field_map[g].customValue=e.target.value:n.field_map[g].customValue=e,c(D({},n))};export{Fe as a,Ce as b,l as c,he as d,pe as e,De as f,me as g,Se as h,ye as s};
