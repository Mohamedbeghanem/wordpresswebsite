var P=Object.defineProperty;var v=Object.getOwnPropertySymbols;var w=Object.prototype.hasOwnProperty,y=Object.prototype.propertyIsEnumerable;var j=(a,t,s)=>t in a?P(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s,C=(a,t)=>{for(var s in t||(t={}))w.call(t,s)&&j(a,s,t[s]);if(v)for(var s of v(t))y.call(t,s)&&j(a,s,t[s]);return a};import{h as M,r as i,j as r}from"./main.js";import{c as F,_ as R,a as n}from"./bi-336-181.js";import{S as L}from"./bi-980-944.js";import{e as E}from"./bi-171-733.js";import{I as O}from"./bi-803-734.js";import T from"./bi-28-394.js";import{h as q,c as N}from"./bi-466-931.js";import{S as z}from"./bi-579-932.js";import"./bi-212-737.js";import"./bi-811-731.js";import"./bi-648-738.js";function Z({formFields:a,setFlow:t,flow:s,allIntegURL:f}){const u=M(),[g,d]=i.useState(!1),[S,h]=i.useState({}),[o,x]=i.useState(1),[_,p]=i.useState({show:!1}),[e,c]=i.useState({name:"Salesmate",type:"Salesmate",session_token:"",link_name:"",field_map:[{formField:"",salesmateFormField:""}],actionName:"",actionId:"",salesmateFields:[],actions:{}}),k=()=>{d(!0),E(s,t,f,e,u,"","",d).then(m=>{var b;m.success?(n.success((b=m.data)==null?void 0:b.msg),u(f)):n.error(m.data||m)})},I=l=>{if(!N(e)){n.error("Please map mandatory fields");return}if(!e.selectedCRMOwner){n.error("Please select a Owner");return}if(Number(e.actionId)===4){if(!e.selectedCRMContact){n.error("Please select a Contact");return}if(!e.selectedCRMPipeline){n.error("Please select a Pipeline");return}if(!e.selectedCRMStage){n.error("Please select a Stage");return}}e.field_map.length>0&&x(l)};return document.querySelector(".btcd-s-wrp").scrollTop=0,r.jsxs("div",{children:[r.jsx(F,{snack:_,setSnackbar:p}),r.jsx("div",{className:"txt-center mt-2",children:r.jsx(L,{step:3,active:o})}),r.jsx(T,{salesmateConf:e,setSalesmateConf:c,step:o,setStep:x,loading:S,setLoading:h,setSnackbar:p}),r.jsxs("div",{className:"btcd-stp-page",style:C({},o===2&&{width:900,height:"auto",overflow:"visible"}),children:[r.jsx(z,{formFields:a,handleInput:l=>q(l,e,c),salesmateConf:e,setSalesmateConf:c,loading:S,setLoading:h,isLoading:g,setIsLoading:d,setSnackbar:p}),(e==null?void 0:e.actionName)&&r.jsxs("button",{onClick:()=>I(3),disabled:!N(e),className:"btn f-right btcd-btn-lg green sh-sm flx",type:"button",children:[R("Next","bit-integrations")," ","Â ",r.jsx("div",{className:"btcd-icn icn-arrow_back rev-icn d-in-b"})]})]}),(e==null?void 0:e.actionName)&&r.jsx(O,{step:o,saveConfig:()=>k(),isLoading:g,dataConf:e,setDataConf:c,formFields:a})]})}export{Z as default};
