var y=Object.defineProperty,_=Object.defineProperties;var b=Object.getOwnPropertyDescriptors;var m=Object.getOwnPropertySymbols;var g=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var p=(e,s,t)=>s in e?y(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,u=(e,s)=>{for(var t in s||(s={}))g.call(s,t)&&p(e,t,s[t]);if(m)for(var t of m(s))K.call(s,t)&&p(e,t,s[t]);return e},o=(e,s)=>_(e,b(s));import{_ as f,b as F,a as n}from"./bi-336-181.js";import{e as q,s as A}from"./bi-171-733.js";const v=(e,s,t)=>{const r=u({},s),{name:a}=e.target;e.target.value!==""?r[a]=e.target.value:delete r[a],t(u({},r))},x=(e,s,t,r,a,i)=>{if(!e.authKey){t({authKey:e.authKey?"":f("API key can't be empty","bit-integrations")});return}t({}),i(o(u({},a),{auth:!0}));const c={authKey:e.authKey};F(c,"klaviyo_handle_authorize").then(l=>{if(l&&l.success){const d=u({},e);l.data&&(d.default||(d.default={}),d.default.lists=l.data),s(d),r(!0),i(o(u({},a),{auth:!1})),n.success(f("Authorized successfully","bit-integrations"));return}i(o(u({},a),{auth:!1})),n.error(f("Authorized failed","bit-integrations"))})},M=(e,s,t,r)=>{r(o(u({},t),{list:!0}));const a={authKey:e.authKey};F(a,"klaviyo_handle_authorize").then(i=>{if(i&&i.success){const c=u({},e);i.data&&(c.default||(c.default={}),c.default.lists=i.data),s(c),r(o(u({},t),{list:!1})),n.success(f("List refresh successfully","bit-integrations"));return}r(o(u({},t),{list:!1})),n.error(f("List refresh failed","bit-integrations"))})},k=e=>{const s=e==null?void 0:e.klaviyoFields.filter(t=>t.required===!0);return s.length>0?s.map(t=>({formField:"",klaviyoFormField:t.key})):[{formField:"",klaviyoFormField:""}]},h=e=>!((e!=null&&e.field_map?e.field_map.filter(t=>!t.formField||!t.klaviyoFormField||!t.formField==="custom"&&!t.customValue):[]).length>0),H=(e,s,t)=>{if(!h(e)){n.error("Please map mandatory fields");return}e.field_map.length>0&&s(t),document.querySelector(".btcd-s-wrp").scrollTop=0},I=(e,s,t,r,a,i)=>{i(!0),q(e,s,t,r,a,"","",i).then(l=>{var d;l.success?(n.success((d=l.data)==null?void 0:d.msg),a(t)):n.error(l.data||l)})},S=(e,s,t,r,a,i)=>{if(!h(t)){n.error("Please map mandatory fields");return}if(h(t)==="required"){n.error("You must select email or phone in klaviyo fields");return}A({flow:e,allIntegURL:s,conf:t,navigate:r,edit:a,setIsLoading:i})};export{M as a,I as b,v as e,k as g,x as h,H as n,S as s};
