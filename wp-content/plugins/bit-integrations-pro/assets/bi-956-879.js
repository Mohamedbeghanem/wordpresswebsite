var A=Object.defineProperty;var F=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var w=(t,i,s)=>i in t?A(t,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[i]=s,x=(t,i)=>{for(var s in i||(i={}))$.call(i,s)&&w(t,s,i[s]);if(F)for(var s of F(i))R.call(i,s)&&w(t,s,i[s]);return t};import{r as v,j as e,L as T,l as V}from"./main.js";import{a2 as N,_ as r,d as I,a3 as S,x as L}from"./bi-336-181.js";import{g as y,a as q,e as U,b as _}from"./bi-824-878.js";import{S as z}from"./bi-648-738.js";import{T as G}from"./bi-993-739.js";import{h as P}from"./bi-171-733.js";function B({emailOctopusConf:t,setEmailOctopusConf:i,loading:s,setLoading:a}){var j,g,l;const[d,c]=v.useState({show:!1,action:()=>{}}),m=(n,b)=>{var p;const h=x({},t);b==="tag"&&((p=n.target)!=null&&p.checked?(y(t,i,a),h.actions.tags=!0):(c({show:!1}),delete h.actions.tags),c({show:"tag"})),b==="update"&&(n.target.checked?h.actions.update=!0:delete h.actions.update),b==="status"&&(n.target.checked?h.actions.status=!0:delete h.actions.status),i(x({},h))},u=()=>{c({show:!1})},o=n=>{const b=x({},t);b.selectedTags=n,i(x({},b))};return e.jsxs("div",{className:"pos-rel d-flx w-8",children:[e.jsx(N,{checked:(t==null?void 0:t.selectedTags.length)||!1,onChange:n=>m(n,"tag"),className:"wdt-200 mt-4 mr-2",value:"tags",title:r("Add Tags","bit - integrations"),subTitle:r("Selects tags for contact")}),e.jsx(N,{checked:((j=t.actions)==null?void 0:j.update)||!1,onChange:n=>m(n,"update"),className:"wdt-200 mt-4 mr-2",value:"update_contact",title:r("Update contact","bit-integrations"),subTitle:r("Update an existing contact's info by responses.","bit-integrations")}),e.jsx(N,{checked:((g=t.actions)==null?void 0:g.status)||!1,onChange:n=>m(n,"status"),className:"wdt-200 mt-4 mr-2",value:"subscriber_status",title:r("Unsubscribe contact","bit-integrations"),subTitle:r('Set the contact status to "unsubscribed".',"bit-integrations")}),e.jsxs(I,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:r("Ok","bit-integrations"),show:d.show==="tag",close:u,action:u,title:r("Tags","bit-integrations"),children:[e.jsx("div",{className:"btcd-hr mt-2 mb-2"}),e.jsx("div",{className:"mt-2",children:r("Select tags","bit-integrations")}),s.tags?e.jsx(T,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):e.jsxs("div",{className:"flx flx-between mt-2",children:[e.jsx(S,{options:(l=t==null?void 0:t.tags)==null?void 0:l.map(n=>({label:n.name,value:n.name})),className:"msl-wrp-options",defaultValue:t==null?void 0:t.selectedTags,onChange:n=>o(n)}),e.jsx("button",{onClick:()=>y(t,i,a),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`${r("Refresh Groups","bit-integrations")}'`},type:"button",children:"↻"})]})]})]})}const M=(t,i,s)=>{const a=x({},i);a.field_map.splice(t,0,{}),s(x({},a))},H=(t,i,s)=>{const a=x({},i);a.field_map.length>1&&a.field_map.splice(t,1),s(x({},a))},k=(t,i,s,a)=>{const d=x({},s);d.field_map[i][t.target.name]=t.target.value,t.target.value==="custom"&&(d.field_map[i].customValue=""),a(x({},d))};function D({i:t,formFields:i,field:s,emailOctopusConf:a,setEmailOctopusConf:d}){var j,g;const c=(a==null?void 0:a.emailOctopusFields.filter(l=>l.required===!0))||[],m=(a==null?void 0:a.emailOctopusFields.filter(l=>l.required===!1))||[];if(((j=a==null?void 0:a.field_map)==null?void 0:j.length)===1&&s.emailOctopusFormField===""){const l=x({},a),n=q(l);l.field_map=n,d(l)}const u=V(L),{isPro:o}=u;return e.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:e.jsxs("div",{className:"pos-rel flx",children:[e.jsxs("div",{className:"flx integ-fld-wrp",children:[e.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:s.formField||"",onChange:l=>k(l,t,a,d),children:[e.jsx("option",{value:"",children:r("Select Field","bit-integrations")}),e.jsx("optgroup",{label:"Form Fields",children:i==null?void 0:i.map(l=>e.jsx("option",{value:l.name,children:l.label},`ff-rm-${l.name}`))}),e.jsx("option",{value:"custom",children:r("Custom...","bit-integrations")}),e.jsx("optgroup",{label:`General Smart Codes ${o?"":"(PRO)"}`,children:o&&((g=z)==null?void 0:g.map(l=>e.jsx("option",{value:l.name,children:l.label},`ff-rm-${l.name}`)))})]}),s.formField==="custom"&&e.jsx(G,{onChange:l=>P(l,t,a,d),label:r("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:s.customValue,placeholder:r("Custom Value","bit-integrations"),formFields:i}),e.jsxs("select",{className:"btcd-paper-inp",disabled:t<c.length,name:"emailOctopusFormField",value:t<c?c[t].label||"":s.emailOctopusFormField||"",onChange:l=>k(l,t,a,d),children:[e.jsx("option",{value:"",children:r("Select Field","bit-integrations")}),t<c.length?e.jsx("option",{value:c[t].key,children:c[t].label},c[t].key):m.map(({key:l,label:n})=>e.jsx("option",{value:l,children:n},l))]})]}),t>=c.length&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>M(t,a,d),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),e.jsx("button",{onClick:()=>H(t,a,d),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:e.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}function f({formFields:t,handleInput:i,emailOctopusConf:s,setEmailOctopusConf:a,loading:d,setLoading:c,setSnackbar:m}){var n;const[u,o]=v.useState({name:"",auth_token:""}),[j,g]=v.useState(!1),l=b=>{const h=x({},s);h.selectedList=b,a(x({},h)),_(h,a,c)};return e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsxs("div",{className:"flx",children:[e.jsx("b",{className:"wdt-200 d-in-b",children:r("Select List:","bit-integrations")}),e.jsx(S,{singleSelect:!0,options:(n=s.lists)==null?void 0:n.map(b=>({label:b.name,value:b.id})),className:"msl-wrp-options",defaultValue:s==null?void 0:s.selectedList,onChange:b=>l(b)}),e.jsx("button",{onClick:()=>U(s,a,o,g,d,c,"refreshLists"),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${r("Refresh  Lists","bit-integrations")}'`},type:"button",disabled:d.lists,children:"↻"})]}),(d.lists||d.customFields)&&e.jsx(T,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),e.jsxs("div",{children:[e.jsx("br",{}),e.jsx("div",{className:"mt-5",children:e.jsxs("b",{className:"wdt-100",children:[r("Field Map","bit-integrations"),e.jsx("button",{onClick:()=>_(s,a,c),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${r("Refresh custom fields","bit-integrations")}'`},type:"button",disabled:d.customFields||!s.selectedList,children:"↻"})]})}),e.jsx("br",{}),e.jsx("div",{className:"btcd-hr mt-1"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:r("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:r("EmailOctopus Fields","bit-integrations")})})]}),d.emailOctopusFields&&e.jsxs("div",{children:[" ",s==null?void 0:s.field_map.map((b,h)=>e.jsx(D,{i:h,field:b,emailOctopusConf:s,formFields:t,setEmailOctopusConf:a,setSnackbar:m},`rp-m-${h+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>M(s.field_map.length,s,a),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("div",{className:"mt-4",children:e.jsx("b",{className:"wdt-100",children:r("Actions","bit-integrations")})}),e.jsx("div",{className:"btcd-hr mt-1"}),e.jsx(B,{emailOctopusConf:s,setEmailOctopusConf:a,formFields:t,loading:d,setLoading:c})]})]})]})}export{f as E};
