var R=Object.defineProperty;var C=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var k=(d,o,c)=>o in d?R(d,o,{enumerable:!0,configurable:!0,writable:!0,value:c}):d[o]=c,x=(d,o)=>{for(var c in o||(o={}))H.call(o,c)&&k(d,c,o[c]);if(C)for(var c of C(o))J.call(o,c)&&k(d,c,o[c]);return d};import{r as p,h as K,j as e}from"./main.js";import{b as w,c as Q,g as a,a2 as V,L as W}from"./bi-336-181.js";import{e as X}from"./bi-171-733.js";import{P as j,a as g,c as Y,b as Z}from"./bi-844-767.js";import{p as ee}from"./bi-101-768.js";import{C as te}from"./bi-212-737.js";import"./bi-811-731.js";import"./bi-648-738.js";import"./bi-993-739.js";function me({formFields:d,setFlow:o,flow:c,allIntegURL:I}){var f,_,N;const[M,L]=p.useState([]),[T,$]=p.useState([]),[D,E]=p.useState([]),[u,O]=p.useState([]),q=K(),[A,v]=p.useState(!1),[i,r]=p.useState({name:"Pods",type:"Pods",post_map:[{post_author:"logged_in_user"}],pod_field_map:[{}],pod_file_map:[{}],condition:{action_behavior:"",actions:[{field:"",action:"value"}],logics:[{field:"",logic:"",val:""},"or",{field:"",logic:"",val:""}]}}),[U,m]=p.useState({show:!1}),h=(t,s,l)=>{const n=x({},i);l?n[t]=Number(s):n[t]=s,r(n)},z=(t,s)=>{const l=x({},i);l[t]=s,w({post_type:s},"pods/fields").then(n=>{var F,y,P,S;n!=null&&n.success&&n!==void 0&&(L(Object.values((F=n==null?void 0:n.data)==null?void 0:F.podFields)),$(Object.values((y=n==null?void 0:n.data)==null?void 0:y.podFiles)),n!=null&&n.data&&(l.pod_field_map=Object.values((P=n==null?void 0:n.data)==null?void 0:P.podFields).filter(b=>b.required).map(b=>({formField:"",podFormField:b.key,required:b.required})),((S=l==null?void 0:l.pod_field_map)==null?void 0:S.length)<1&&(l.pod_field_map=[{}])),r(l))})};p.useEffect(()=>{w({},"pods/list","","GET").then(t=>{const{data:s}=t;O(s==null?void 0:s.post_types),E(s.users)})},[]);const B=(t,s)=>{const l=x({},i);s?l.condition.action_behavior=t:l.condition.action_behavior="",r(l)},G=()=>{if(!i.post_type){m({show:!0,msg:a("Pod cann't be empty","bit-integrations")});return}if(!i.post_status){m({show:!0,msg:a("Post Status cann't be empty","bit-integrations")});return}if(!Y(i)){m({show:!0,msg:a("Please map mandatory fields","bit-integrations")});return}if(!Z(i)){m({show:!0,msg:a("Please map mandatory fields","bit-integrations")});return}v(!0),X(c,o,I,i,q,"","",v)};return e.jsxs("div",{style:{width:900},children:[e.jsx(Q,{snack:U,setSnackbar:m}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:a("Integration Name ","bit-integrations")})}),e.jsx("input",{className:"btcd-paper-inp w-5 mt-1",onChange:t=>h(t.target.name,t.target.value),name:"name",value:i.name,type:"text",placeholder:a("Integration Name...","bit-integrations")}),e.jsxs("div",{className:"mt-3",children:[e.jsx("b",{children:a("Pod","bit-integrations")})," ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs("select",{name:"post_type",onChange:t=>z(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{disabled:!0,selected:!0,children:"Select Type"}),u==null?void 0:u.map((t,s)=>e.jsx("option",{value:t.name,children:t.label},`pod-${s*2}`))]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("b",{children:a("Post Status","bit-integrations")})," ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs("select",{name:"post_status",onChange:t=>h(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{disabled:!0,selected:!0,children:a("Select Status","bit-integrations")}),e.jsx("option",{value:"publish",children:"Publish"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"inherit",children:"Inherit"}),e.jsx("option",{value:"auto-draft",children:"Auto-Draft"}),e.jsx("option",{value:"private ",children:"Private"}),e.jsx("option",{value:"pending",children:"Pending"})]}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:a("Comment Status","bit-integrations")})}),e.jsxs("select",{name:"comment_status",onChange:t=>h(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{disabled:!0,selected:!0,children:a("Select Status","bit-integrations")}),e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"closed",children:"Closed"})]}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:a("Author","bit-integrations")})}),e.jsxs("select",{name:"post_author",onChange:t=>h(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{disabled:!0,selected:!0,children:a("Select Author","bit-integrations")}),e.jsx("option",{value:"logged_in_user",children:"Logged In User"}),D.map((t,s)=>e.jsx("option",{value:t.ID,children:t.display_name},`pod-${s*2}`))]}),e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("div",{className:"mt-3 mb-1",children:e.jsx("b",{children:"Post Fields Mapping"})}),e.jsx("div",{className:"btcd-hr"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("Post Fields","bit-integrations")})})]})]}),(f=i==null?void 0:i.post_map)==null?void 0:f.map((t,s)=>e.jsx(j,{i:s,type:"post",field:t,formFields:d,podsConf:i,setPodsConf:r,podFields:ee,fieldType:"fields"},`analytics-m-${s+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>g("post_map",i.post_map.length,i,r),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsxs("div",{children:[e.jsx("div",{className:"mt-3 mb-1",children:e.jsx("b",{children:"Pod Fields Mapping"})}),e.jsx("div",{className:"btcd-hr"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("Pod Fields","bit-integrations")})})]})]}),i.pod_field_map.map((t,s)=>e.jsx(j,{i:s,type:"pod",field:t,formFields:d,podsConf:i,setPodsConf:r,podFields:M,fieldType:"fields"},`analytics-m-${s+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>g("pod_field_map",i.pod_field_map.length,i,r),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsxs("div",{children:[e.jsx("div",{className:"mt-3 mb-1",children:e.jsx("b",{children:"Pod File Upload Mapping"})}),e.jsx("div",{className:"btcd-hr"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("Pod Fields","bit-integrations")})})]})]}),i.pod_file_map.map((t,s)=>e.jsx(j,{i:s,type:"podFile",field:t,formFields:d,podsConf:i,setPodsConf:r,podFields:T,fieldType:"file"},`analytics-m-${s+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>g("pod_file_map",i.pod_file_map.length,i,r),className:"icn-btn sh-sm",type:"button",children:"+"})})]}),(i==null?void 0:i.condition)&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flx",children:e.jsx(V,{onChange:t=>B(t.target.value,t.target.checked),checked:((_=i==null?void 0:i.condition)==null?void 0:_.action_behavior)==="cond",className:"wdt-200 mt-4 mr-2",value:"cond",title:a("Conditional Logics","bit_integration")})}),e.jsx("br",{}),((N=i==null?void 0:i.condition)==null?void 0:N.action_behavior)==="cond"&&e.jsx(te,{formFields:d,dataConf:i,setDataConf:r})]}),e.jsxs("button",{className:"btn f-left btcd-btn-lg green sh-sm flx",type:"button",onClick:()=>G(),children:[a("Save","bit-integrations")," ",A&&e.jsx(W,{size:20,clr:"#022217",className:"ml-2"})]})]})}export{me as default};
