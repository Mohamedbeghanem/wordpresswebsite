var R=Object.defineProperty;var C=Object.getOwnPropertySymbols;var w=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var h=(s,t,a)=>t in s?R(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,g=(s,t)=>{for(var a in t||(t={}))w.call(t,a)&&h(s,a,t[a]);if(C)for(var a of C(t))A.call(t,a)&&h(s,a,t[a]);return s};import{h as D,r as l,j as r}from"./main.js";import{c as E,_ as I,a as i}from"./bi-336-181.js";import{S as O}from"./bi-980-944.js";import{e as T}from"./bi-171-733.js";import{I as L}from"./bi-803-734.js";import z from"./bi-836-380.js";import{h as W,c as x}from"./bi-273-905.js";import{C as Z}from"./bi-133-906.js";import"./bi-212-737.js";import"./bi-811-731.js";import"./bi-648-738.js";function te({formFields:s,setFlow:t,flow:a,allIntegURL:p}){const b=D(),[N,m]=l.useState(!1),[f,y]=l.useState({}),[o,k]=l.useState(1),[j,c]=l.useState({show:!1}),S=[{key:"name",label:"Name",required:!0},{key:"emailAddresses",label:"Email",required:!1},{key:"about",label:"About",required:!1},{key:"street",label:"Street",required:!1},{key:"city",label:"City",required:!1},{key:"state",label:"State",required:!1},{key:"zip",label:"Zip Code",required:!1},{key:"country",label:"Country",required:!1},{key:"phoneNumbers",label:"Phone",required:!1},{key:"websites",label:"Website",required:!1}],v=[{key:"firstName",label:"First Name",required:!0},{key:"lastName",label:"Last Name",required:!1},{key:"title",label:"Title",required:!1},{key:"jobTitle",label:"Job Title",required:!1},{key:"emailAddresses",label:"Email",required:!1},{key:"about",label:"About",required:!1},{key:"street",label:"Street",required:!1},{key:"city",label:"City",required:!1},{key:"state",label:"State",required:!1},{key:"zip",label:"Zip Code",required:!1},{key:"country",label:"Country",required:!1},{key:"phoneNumbers",label:"Phone",required:!1},{key:"websites",label:"Website",required:!1}],M=[{key:"name",label:"Opportunity Name",required:!0},{key:"description",label:"Opportunity Details",required:!1},{key:"value",label:"Bid Amount",required:!1},{key:"expectedCloseOn",label:"Expected Close Date",required:!1},{key:"closedOn",label:"Actual Close Date",required:!1}],_=[{key:"name",label:"Project Name",required:!0},{key:"description",label:"Description",required:!1},{key:"expectedCloseOn",label:"Expected Close Date",required:!1}],[e,n]=l.useState({name:"CapsuleCRM",type:"CapsuleCRM",api_key:"",api_url:"",field_map:[{formField:"",capsulecrmFormField:""}],actionName:"",organisationFields:S,personFields:v,opportunityFields:M,projectFields:_,actions:{}}),F=()=>{m(!0),T(a,t,p,e,b,"","",m).then(u=>{var q;u.success?(i.success((q=u.data)==null?void 0:q.msg),b(p)):i.error(u.data||u)})},P=d=>{if(!x(e)){i.error("Please map mandatory fields");return}if(e.actionName==="opportunity"||e.actionName==="project"){if(!e.selectedCRMParty){i.error("Please select a party");return}if(!e.selectedCRMMilestones&&e.actionName==="opportunity"){i.error("Please select a Milestone");return}}e.field_map.length>0&&k(d)};return document.querySelector(".btcd-s-wrp").scrollTop=0,r.jsxs("div",{children:[r.jsx(E,{snack:j,setSnackbar:c}),r.jsx("div",{className:"txt-center mt-2",children:r.jsx(O,{step:3,active:o})}),r.jsx(z,{capsulecrmConf:e,setCapsuleCRMConf:n,step:o,setStep:k,loading:f,setLoading:y,setSnackbar:c}),r.jsxs("div",{className:"btcd-stp-page",style:g({},o===2&&{width:900,height:"auto",overflow:"visible"}),children:[r.jsx(Z,{formFields:s,handleInput:d=>W(d,e,n),capsulecrmConf:e,setCapsuleCRMConf:n,loading:f,setLoading:y,setSnackbar:c}),(e==null?void 0:e.actionName)&&r.jsxs("button",{onClick:()=>P(3),disabled:!x(e),className:"btn f-right btcd-btn-lg green sh-sm flx",type:"button",children:[I("Next","bit-integrations")," ","Â ",r.jsx("div",{className:"btcd-icn icn-arrow_back rev-icn d-in-b"})]})]}),(e==null?void 0:e.actionName)&&r.jsx(L,{step:o,saveConfig:()=>F(),isLoading:N,dataConf:e,setDataConf:n,formFields:s})]})}export{te as default};
