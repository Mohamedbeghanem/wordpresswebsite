var M=Object.defineProperty;var x=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var j=(o,s,n)=>s in o?M(o,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[s]=n,u=(o,s)=>{for(var n in s||(s={}))P.call(s,n)&&j(o,n,s[n]);if(x)for(var n of x(s))T.call(s,n)&&j(o,n,s[n]);return o};import{u as q,r as m,h as B,j as t}from"./main.js";import{b as D,c as z,_ as c,a2 as A,a8 as w,L as G}from"./bi-336-181.js";import{e as H}from"./bi-171-733.js";import{u as k,U as O,C as J,c as K}from"./bi-261-792.js";import{C as Q}from"./bi-212-737.js";import{C as y}from"./bi-759-751.js";import"./bi-811-731.js";import"./bi-648-738.js";import"./bi-993-739.js";function se({formFields:o,setFlow:s,flow:n,allIntegURL:U}){var _,v;const{formID:p}=q(),[C,h]=m.useState({show:!1}),[N,S]=m.useState([]),F=B(),[g,f]=m.useState(!1),[e,d]=m.useState({name:"User Registration",type:"Registration",user_map:[{}],meta_map:[{}],condition:{action_behavior:"",actions:[{field:"",action:"value"}],logics:[{field:"",logic:"",val:""},"or",{field:"",logic:"",val:""}]}});m.useEffect(()=>{var l,r;const i=u({},e);D({},"role/list",null,"GET").then(a=>{a!=null&&a.success&&a!==void 0&&S(Object.values(a==null?void 0:a.data))}),(r=(l=i==null?void 0:i.user_map)==null?void 0:l[0])!=null&&r.userField||(i.user_map=k.filter(a=>a.required).map(a=>({formField:"",userField:a.key,required:a.required}))),d(i)},[]);const I=()=>{if(!e.action_type){h({show:!0,msg:c("Please select action type","bit-integrations")});return}if(!e.user_role&&e.action_type!=="updated_user"){h({show:!0,msg:c("User Role cann't be empty","bit-integrations")});return}if(!K(e)&&e.action_type!=="updated_user"){h({show:!0,msg:c("Please map mandatory fields","bit-integrations")});return}f(!0),H(n,s,U,e,F,"","",f)},L=(i,l)=>{const r=u({},e);l?r.condition.action_behavior=i:r.condition.action_behavior="",d(r)},b=i=>{const l=u({},e),{name:r,value:a}=i.target;i.target.checked&&(l[r]=a),d(u({},l))},R=`
  <ul>
  <li>The user must be logged in when updating profile</li>
  <li>The user cannot change the value of the username field when updating the user profile.</li>
     
  </ul>`,E=`
  <ul>
  <li>If the Username and Password fields are blank then the user will take the value of the email field as the field and the password will be auto-generated.</li>
     
  </ul>`;return t.jsxs("div",{style:{width:900},children:[t.jsx(z,{snack:C,setSnackbar:h}),t.jsx("div",{className:"font-w-m mt-3",children:c("Action type","bit-integrations")}),t.jsxs("div",{children:[t.jsx(y,{radio:!0,name:"action_type",onChange:b,checked:(e==null?void 0:e.action_type)==="new_user",value:"new_user",title:c("New User Create","bit-integrations")}),t.jsx(y,{radio:!0,name:"action_type",onChange:b,checked:(e==null?void 0:e.action_type)==="updated_user",value:"updated_user",title:c("Updated User","bit-integrations")})]}),t.jsx("div",{children:t.jsx(O,{formFields:o,formID:p,userConf:e,setUserConf:d,roles:N,userFields:k})}),t.jsxs("div",{children:[t.jsx(J,{formFields:o,formID:p,userConf:e,setUserConf:d}),t.jsx("br",{})]}),(e==null?void 0:e.condition)&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flx",children:t.jsx(A,{onChange:i=>L(i.target.value,i.target.checked),checked:((_=e==null?void 0:e.condition)==null?void 0:_.action_behavior)==="cond",className:"wdt-200 mt-4 mr-2",value:"cond",title:c("Conditional Logics","bit_integration")})}),t.jsx("br",{}),((v=e==null?void 0:e.condition)==null?void 0:v.action_behavior)==="cond"&&t.jsx(Q,{formFields:o,dataConf:e,setDataConf:d})]}),(e==null?void 0:e.action_type)==="updated_user"?t.jsx(w,{note:R}):t.jsx(w,{note:E}),t.jsxs("button",{className:"btn f-left btcd-btn-lg green sh-sm flx",type:"button",onClick:()=>I(),disabled:g,children:[c("Save","bit-integrations"),g&&t.jsx(G,{size:20,clr:"#022217",className:"ml-2"})]})]})}export{se as default};
