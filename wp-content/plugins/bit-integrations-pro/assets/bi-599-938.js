var q=Object.defineProperty;var R=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var T=(t,s,c)=>s in t?q(t,s,{enumerable:!0,configurable:!0,writable:!0,value:c}):t[s]=c,g=(t,s)=>{for(var c in s||(s={}))P.call(s,c)&&T(t,c,s[c]);if(R)for(var c of R(s))D.call(s,c)&&T(t,c,s[c]);return t};import{r as E,j as e,L as A,l as W}from"./main.js";import{a2 as k,_ as a,d as _,a3 as S,x as B}from"./bi-336-181.js";import{g as V,a as I,b as G}from"./bi-1-937.js";import{S as L}from"./bi-648-738.js";function Q({companyHubConf:t,setCompanyHubConf:s,loading:c,setLoading:l}){var v,d,i,o,w,M;const[h,x]=E.useState({show:!1,action:()=>{}}),m=(r,F)=>{var u,$,O;const n=g({},t);F==="company"?(u=r.target)!=null&&u.checked?(n.companies===void 0&&(n.companies=V(t,s,l)),n.actions.company=!0):(x({show:!1}),delete n.actions.company):F==="source"?($=r.target)!=null&&$.checked?(n.sources===void 0&&(n.sources=["Web","Call","Referral","Other"]),n.actions.source=!0):(x({show:!1}),delete n.actions.source):F==="contact"&&((O=r.target)!=null&&O.checked?(n.contacts===void 0&&(n.contacts=I(t,s,l)),n.actions.contact=!0):(x({show:!1}),delete n.actions.contact)),x({show:F}),s(g({},n))},j=()=>{x({show:!1})},N=(r,F)=>{s(n=>(n[F]=r,n))};return e.jsxs("div",{className:"pos-rel d-flx flx-wrp",children:[(t.actionName==="contact"||t.actionName==="deal")&&e.jsx(k,{checked:((v=t==null?void 0:t.selectedCompany)==null?void 0:v.length)||!1,onChange:r=>m(r,"company"),className:"wdt-200 mt-4 mr-2",value:"company",title:a("Add Company","bit - integrations"),subTitle:a("Add Company")}),t.actionName==="contact"&&e.jsx(k,{checked:((d=t==null?void 0:t.selectedSource)==null?void 0:d.length)||!1,onChange:r=>m(r,"source"),className:"wdt-200 mt-4 mr-2",value:"source",title:a("Add Source","bit - integrations"),subTitle:a("Add Contact Source")}),t.actionName==="deal"&&e.jsx(k,{checked:((i=t==null?void 0:t.selectedContact)==null?void 0:i.length)||!1,onChange:r=>m(r,"contact"),className:"wdt-200 mt-4 mr-2",value:"contact",title:a("Add Contact","bit - integrations"),subTitle:a("Add Contact")}),e.jsxs(_,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:a("Ok","bit-integrations"),show:h.show==="company",close:j,action:j,title:a("company","bit-integrations"),children:[e.jsx("div",{className:"btcd-hr mt-2 mb-2"}),e.jsx("div",{className:"mt-2",children:a("Select Company","bit-integrations")}),c.companies?e.jsx(A,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):e.jsxs("div",{className:"flx flx-between mt-2",children:[e.jsx(S,{options:(o=t==null?void 0:t.companies)==null?void 0:o.map(r=>({label:r.name,value:`${r.id}`})),className:"msl-wrp-options",defaultValue:t==null?void 0:t.selectedCompany,onChange:r=>N(r,"selectedCompany"),singleSelect:!0,closeOnSelect:!0}),e.jsx("button",{onClick:()=>V(t,s,l),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`${a("Refresh Companies","bit-integrations")}'`},type:"button",children:"↻"})]})]}),e.jsxs(_,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:a("Ok","bit-integrations"),show:h.show==="source",close:j,action:j,title:a("Source","bit-integrations"),children:[e.jsx("div",{className:"btcd-hr mt-2 mb-2"}),e.jsx("div",{className:"mt-2",children:a("Select Source","bit-integrations")}),e.jsx("div",{className:"flx flx-between mt-2",children:e.jsx(S,{options:(w=t==null?void 0:t.sources)==null?void 0:w.map(r=>({label:r,value:r})),className:"msl-wrp-options",defaultValue:t==null?void 0:t.selectedSource,onChange:r=>N(r,"selectedSource"),singleSelect:!0,closeOnSelect:!0})})]}),e.jsxs(_,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:a("Ok","bit-integrations"),show:h.show==="contact",close:j,action:j,title:a("Contact","bit-integrations"),children:[e.jsx("div",{className:"btcd-hr mt-2 mb-2"}),e.jsx("div",{className:"mt-2",children:a("Select Contact","bit-integrations")}),c.contact?e.jsx(A,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):e.jsxs("div",{className:"flx flx-between mt-2",children:[e.jsx(S,{options:(M=t==null?void 0:t.contacts)==null?void 0:M.map(r=>({label:r.name,value:`${r.id}`})),className:"msl-wrp-options",defaultValue:t==null?void 0:t.selectedContact,onChange:r=>N(r,"selectedContact"),singleSelect:!0,closeOnSelect:!0}),e.jsx("button",{onClick:()=>I(t,s,l),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`${a("Refresh Contacts","bit-integrations")}'`},type:"button",children:"↻"})]})]})]})}const p=(t,s,c)=>{const l=g({},s);l.field_map.splice(t,0,{}),c(g({},l))},z=(t,s,c)=>{const l=g({},s);l.field_map.length>1&&l.field_map.splice(t,1),c(g({},l))},b=(t,s,c,l)=>{const h=g({},c);h.field_map[s][t.target.name]=t.target.value,t.target.value==="custom"&&(h.field_map[s].customValue=""),l(g({},h))};function J({i:t,formFields:s,field:c,companyHubConf:l,setCompanyHubConf:h}){var d;let x=[];l.actionName==="contact"?x=l==null?void 0:l.contactFields:l.actionName==="company"?x=l==null?void 0:l.companyFields:l.actionName==="deal"&&(x=l==null?void 0:l.dealFields);const m=x.filter(i=>i.required===!0)||[],j=x.filter(i=>i.required===!1)||[],N=W(B),{isPro:v}=N;return e.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:e.jsxs("div",{className:"pos-rel flx",children:[e.jsxs("div",{className:"flx integ-fld-wrp",children:[e.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:c.formField||"",onChange:i=>b(i,t,l,h),children:[e.jsx("option",{value:"",children:a("Select Field","bit-integrations")}),e.jsx("optgroup",{label:"Form Fields",children:s==null?void 0:s.map(i=>e.jsx("option",{value:i.name,children:i.label},`ff-rm-${i.name}`))}),e.jsx("option",{value:"custom",children:a("Custom...","bit-integrations")}),e.jsx("optgroup",{label:`General Smart Codes ${v?"":"(PRO)"}`,children:v&&((d=L)==null?void 0:d.map(i=>e.jsx("option",{value:i.name,children:i.label},`ff-rm-${i.name}`)))})]}),c.formField==="custom"&&e.jsx(CustomField,{field:c,index:t,conf:l,setConf:h,fieldValue:"customValue",fieldLabel:"Custom Value",className:"mr-2"}),e.jsxs("select",{className:"btcd-paper-inp",disabled:t<m.length,name:"companyHubFormField",value:t<m.length?m[t].key||"":c.companyHubFormField||"",onChange:i=>b(i,t,l,h),children:[e.jsx("option",{value:"",children:a("Select Field","bit-integrations")}),t<m.length?e.jsx("option",{value:m[t].key,children:m[t].label},m[t].key):j.map(({key:i,label:o})=>e.jsx("option",{value:i,children:o},i))]})]}),t>=m.length&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>p(t,l,h),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),e.jsx("button",{onClick:()=>z(t,l,h),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:e.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}function f({formFields:t,companyHubConf:s,setCompanyHubConf:c,loading:l,setLoading:h,isLoading:x,setIsLoading:m,setSnackbar:j}){const N=d=>{const i=g({},s),{name:o}=d.target;if(d.target.value!==""){i[o]=d.target.value;let w=[];d.target.value==="contact"?w=s==null?void 0:s.contactFields:d.target.value==="company"?w=s==null?void 0:s.companyFields:d.target.value==="deal"&&(w=s==null?void 0:s.dealFields),i.field_map=G(w)}else delete i[o],delete i.actionId;c(i)},v=(d,i)=>{c(o=>(o[i]=d,o))};return e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("b",{className:"wdt-200 d-in-b",children:a("Select Action:","bit-integrations")}),e.jsxs("select",{onChange:N,name:"actionName",value:s.actionName,className:"btcd-paper-inp w-5",children:[e.jsx("option",{value:"",children:a("Select an action","bit-integrations")}),e.jsx("option",{value:"contact","data-action_name":"contact",children:a("Create Contact","bit-integrations")}),e.jsx("option",{value:"company","data-action_name":"company",children:a("Create Company","bit-integrations")}),e.jsx("option",{value:"deal","data-action_name":"deal",children:a("Create Deal","bit-integrations")})]}),x&&e.jsx(A,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),s.actionName==="deal"&&!x&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{className:"flx",children:[e.jsx("b",{className:"wdt-200 d-in-b",children:a("Select Deal Stage:","bit-integrations")}),e.jsx(S,{options:["Prospecting","Qualification","Discussion","Proposal","Review","Closed Won","Closed Lost"].map(d=>({label:d,value:d})),className:"msl-wrp-options dropdown-custom-width",defaultValue:s==null?void 0:s.selectedStage,onChange:d=>v(d,"selectedStage"),singleSelect:!0,closeOnSelect:!0})]})]}),s.actionName&&!x&&e.jsxs("div",{children:[e.jsx("br",{}),e.jsxs("div",{className:"mt-5",children:[e.jsx("b",{className:"wdt-100",children:a("Field Map","bit-integrations")}),e.jsx("button",{className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${a("Refresh Fields","bit-integrations")}'`},type:"button",children:"↻"})]}),e.jsx("br",{}),e.jsx("div",{className:"btcd-hr mt-1"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("CompanyHub Fields","bit-integrations")})})]}),s==null?void 0:s.field_map.map((d,i)=>e.jsx(J,{i,field:d,companyHubConf:s,formFields:t,setCompanyHubConf:c,setSnackbar:j},`rp-m-${i+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>p(s.field_map.length,s,c),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("div",{className:"mt-4",children:e.jsx("b",{className:"wdt-100",children:a("Actions","bit-integrations")})}),e.jsx("div",{className:"btcd-hr mt-1"}),e.jsx(Q,{companyHubConf:s,setCompanyHubConf:c,formFields:t,loading:l,setLoading:h})]})]})}export{f as C};
